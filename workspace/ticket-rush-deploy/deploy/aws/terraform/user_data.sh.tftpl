#!/bin/bash
set -euxo pipefail

dnf update -y
dnf install -y docker awscli

systemctl enable docker
systemctl start docker

# docker compose plugin
mkdir -p /usr/local/lib/docker/cli-plugins
curl -SL https://github.com/docker/compose/releases/download/v2.29.7/docker-compose-linux-x86_64 \
  -o /usr/local/lib/docker/cli-plugins/docker-compose
chmod +x /usr/local/lib/docker/cli-plugins/docker-compose

usermod -aG docker ec2-user

mkdir -p /opt/${project_name}
chown -R ec2-user:ec2-user /opt/${project_name}
